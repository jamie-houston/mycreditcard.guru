{% extends 'base.html' %}

{% block title %}{{ profile_owner }}'s Credit Card Profile - Credit Card Guru{% endblock %}

{% block extra_css %}
<style>
.shared-profile-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 30px;
    border-radius: 16px;
    margin-bottom: 30px;
    text-align: center;
}

.shared-profile-badge {
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 20px;
    padding: 8px 16px;
    display: inline-block;
    margin-bottom: 15px;
    font-size: 14px;
    backdrop-filter: blur(10px);
}

.read-only-notice {
    background: #f0f9ff;
    border: 1px solid #0ea5e9;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 20px;
    color: #0c4a6e;
}

.section {
    background: rgba(255, 255, 255, 0.9);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 16px;
    padding: 24px;
    margin-bottom: 24px;
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
}

.section h2 {
    margin-top: 0;
    color: #1f2937;
    border-bottom: 2px solid #e5e7eb;
    padding-bottom: 10px;
}

.loading, .error {
    text-align: center;
    padding: 40px;
    color: #6b7280;
}

.modal-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.modal-info-item {
    text-align: center;
    padding: 20px;
    background: rgba(248, 250, 252, 0.8);
    border-radius: 12px;
    border: 1px solid rgba(226, 232, 240, 0.5);
}

.modal-info-label {
    font-size: 14px;
    color: #64748b;
    margin-bottom: 8px;
    font-weight: 500;
}

.modal-info-value {
    font-size: 24px;
    font-weight: bold;
    color: #1e293b;
}
</style>
{% endblock %}

{% block content %}
<div class="shared-profile-header">
    <div class="shared-profile-badge">
        üåê Public Profile
    </div>
    <h1>{{ profile_owner }}'s Credit Card Profile</h1>
    <p style="margin: 0; opacity: 0.9;">Shared on {{ profile.updated_at|date:"F j, Y" }}</p>
</div>

<div class="read-only-notice">
    <strong>üëÄ Read-Only View:</strong> This is a shared profile. You're viewing {{ profile_owner }}'s credit card strategy and optimization setup.
</div>

<!-- Category Optimization Section -->
<div class="section">
    <h2>üéØ Optimized Card Usage by Category</h2>
    <p style="color: #6b7280; margin-bottom: 20px;">Here's which card {{ profile_owner }} uses for each category to maximize rewards:</p>
    <div id="categoryOptimization">
        <div class="loading">Loading category recommendations...</div>
    </div>
</div>

<!-- Profile Summary Section -->
<div class="section">
    <h2>üìä Portfolio Summary</h2>
    <div class="modal-info-grid">
        <div class="modal-info-item">
            <div class="modal-info-label">Total Cards</div>
            <div class="modal-info-value" id="totalCards">Loading...</div>
        </div>
        <div class="modal-info-item">
            <div class="modal-info-label">Total Annual Fees</div>
            <div class="modal-info-value" id="totalAnnualFees">Loading...</div>
        </div>
        <div class="modal-info-item">
            <div class="modal-info-label">Estimated Annual Rewards</div>
            <div class="modal-info-value" id="totalAnnualRewards">Loading...</div>
        </div>
        <div class="modal-info-item">
            <div class="modal-info-label">Net Portfolio Value</div>
            <div class="modal-info-value" id="netPortfolioValue">Loading...</div>
        </div>
    </div>
</div>

<!-- Card Collection Section -->
<div class="section">
    <h2>üí≥ Card Collection</h2>
    <div id="cardCollection">
        <div class="loading">Loading card collection...</div>
    </div>
</div>

<!-- Spending Profile Section -->
<div class="section">
    <h2>üìà Spending Profile</h2>
    <p style="color: #6b7280; margin-bottom: 20px;">{{ profile_owner }}'s monthly spending patterns:</p>
    <div id="spendingProfile">
        <div class="loading">Loading spending profile...</div>
    </div>
</div>

<script>
const API_BASE = '/api/cards';

// Load shared profile data (read-only)
document.addEventListener('DOMContentLoaded', function() {
    console.log('Loading shared profile data...');
    // Note: For now, we'll show placeholder data
    // In a full implementation, this would load the actual profile data for the shared user
    
    showPlaceholderData();
});

function showPlaceholderData() {
    // Show placeholder data for the shared profile
    document.getElementById('categoryOptimization').innerHTML = `
        <div style="text-align: center; padding: 40px; color: #6b7280;">
            <p>üîß Category optimization data will be displayed here</p>
            <p style="font-size: 14px;">This would show which cards to use for each spending category</p>
        </div>
    `;
    
    document.getElementById('totalCards').textContent = '3';
    document.getElementById('totalAnnualFees').textContent = '$190';
    document.getElementById('totalAnnualRewards').textContent = '$1,250';
    document.getElementById('netPortfolioValue').textContent = '+$1,060';
    
    document.getElementById('cardCollection').innerHTML = `
        <div style="text-align: center; padding: 40px; color: #6b7280;">
            <p>üí≥ Card collection will be displayed here</p>
            <p style="font-size: 14px;">This would show all cards in the portfolio with details</p>
        </div>
    `;
    
    document.getElementById('spendingProfile').innerHTML = `
        <div style="text-align: center; padding: 40px; color: #6b7280;">
            <p>üìä Spending profile will be displayed here</p>
            <p style="font-size: 14px;">This would show monthly spending by category</p>
        </div>
    `;
}

function showError(message) {
    const sections = ['cardCollection', 'categoryOptimization', 'spendingProfile'];
    sections.forEach(sectionId => {
        const element = document.getElementById(sectionId);
        if (element && element.innerHTML.includes('Loading')) {
            element.innerHTML = `<div class="error">${message}</div>`;
        }
    });
}
</script>

{% endblock %}